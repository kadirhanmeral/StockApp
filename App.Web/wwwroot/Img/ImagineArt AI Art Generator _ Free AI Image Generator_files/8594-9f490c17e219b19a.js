"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8594],{2053:function(e,t,n){var a,r;n.d(t,{d:function(){return a}}),(r=a||(a={})).SIGN_UP="sign-up",r.SIGN_IN="sign-in"},8443:function(e,t,n){n.d(t,{a:function(){return y},m:function(){return N}});var a=n(57437),r=n(16463),i=n(2265),l=n(52247),s=n(22170),o=n.n(s),c=n(29039),d=n(60806),u=n(45331),m=n(9938);async function*g(e){let{isAborted:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new TextDecoder,a="";for(;;){if(null==t?void 0:t()){await e.cancel();break}let{value:r,done:i}=await e.read();if(i)break;let l=(a+=n.decode(r,{stream:!0})).indexOf("\n\n");for(;-1!==l;){let e=a.slice(0,l);for(let t of(a=a.slice(l+2),e.split("\n")))if(t.startsWith("data: ")){let e=JSON.parse(t.substring(6));yield{type:"text",value:e.content};break}l=a.indexOf("\n\n")}}}function p(e,t){return e&&t&&t.length?{...e,annotations:[...t]}:e}async function h(e){let t,{reader:n,abortControllerRef:a,update:r,onFinish:i,generateId:l=m.O,getCurrentDate:s=()=>new Date,lastMessage:o}=e;if(a.current.signal.aborted)return;let c=s(),d={data:[]};for await(let{type:e,value:i}of g(n,{isAborted:()=>a.current.signal.aborted})){"text"===e&&(d.text?d.text={...d.text,content:(d.text.content||"")+i}:d.text={id:l(),role:"system",content:i,model:o.model,modelName:o.modelName,createdAt:c}),"data"===e&&d.data.push(...i);let n=d.text;"message_annotations"===e&&(t?t.push(...i):t=[...i],n=p(d.text,t)),(null==t?void 0:t.length)&&["text"].forEach(e=>{d[e]&&(d[e].annotations=[...t])}),r([n].filter(Boolean).map(e=>({...p(e,t)})),[...d.data])}null==i||i(d)}async function _(e){let{api:t,messages:n,attachedFile:a,lastMessage:r,body:i,interceptor:l,credentials:s,headers:o,abortControllerRef:c,restoreMessagesOnFailure:d,onResponse:u,onUpdate:m,onFinish:g,generateId:p}=e,_=l?l(n,i):new FormData;if(a){let e=[...n.slice(0,-1),r];_.append("data",JSON.stringify({messages:e,...i})),_.append(a.uuid,a.file)}else _.append("data",JSON.stringify({messages:n,...i}));let f=await fetch(t,{method:"POST",body:_,headers:{...o},signal:c.current.signal,credentials:s}).catch(e=>{throw d(),e});if(u)try{await u(f)}catch(e){throw e}if(!f.ok)throw d(),Error(await f.text()||"Failed to fetch the chat response.");if(!f.body)throw Error("The response body is empty.");let x=f.body.getReader();return await h({reader:x,abortControllerRef:c,update:m,onFinish(e){g&&null!=e.text&&g(e.text)},generateId:p,lastMessage:r})}let f=e=>Math.floor(e/1.3),x=(e,t)=>{let n=[...t];return t.length>e&&(n=t.slice(t.length-e)),n.join(" ")},v=(e,t)=>{let n=e[0],a=e[e.length-1],r=[];e.forEach((t,n)=>{0!==n&&n!==e.length-1&&r.push("".concat(t.role,":"),...t.content.split(" "))});let i=x(f(t),r);return i.length&&(n.content="".concat(n.content,". This is the context of the previous chat with the user reply keeping this in mind.\n").concat(i)),[n,a]},I=(e,t)=>{let n="::<doc>".concat(t,"</doc>::");return e.includes(n)?e:"".concat(n).concat(e)},E=async e=>{let{chatRequest:t,mutate:n}=e,a=t.messages,r=a[a.length-1],i=r.image;if(await n(a,!1),!i)throw Error("No image found in the last message");let{caption:l}=await (0,d.b)({image:i});n([...a,{id:(0,m.O)(),role:u.X.SYSTEM,content:'"'.concat(l,'"'),model:r.model}],!1)},b=async e=>{var t,n;let{api:a,chatRequest:r,mutate:i,mutateStreamData:l,existingData:s,extraMetadataRef:c,abortControllerRef:d,interceptor:u,onFinish:g,onResponse:p,shouldContinue:h=!1,maxTokens:f}=e,x=r.messages;await i(x,!1);let E=r.messages.map(e=>{let{id:t,role:n,content:a,model:r}=e;return{id:t,role:n,content:a,model:r}}),b={...E[E.length-1],model:r.messages[r.messages.length-1].model,modelName:r.messages[r.messages.length-1].modelName};if(h&&"system"===b.role){let e={...E[E.length-1]};e.content="continue",e.role="user",E.push({...e,model:e.model})}let T=r.messages[r.messages.length-1].file;T&&(b.content=I(b.content,T.uuid));let w=v(E.length>5?[E[0],...E.slice(-5)]:E,f);await _({api:a,messages:w,attachedFile:T,lastMessage:b,body:{data:r.data,...c.current.body,...null===(t=r.options)||void 0===t?void 0:t.body},interceptor:u,credentials:c.current.credentials,headers:{...c.current.headers,...null===(n=r.options)||void 0===n?void 0:n.headers},abortControllerRef:d,restoreMessagesOnFailure(){i(x,!1)},onResponse:p,onUpdate:o()((e,t)=>{i([...x,...e],!1),l([...s||[],...t||[]],!1)},500),onFinish:g,generateId:m.O})};var T=n(10733),w=n(36805);let j=l.v.IMAGINE_BOT_CHAT_URL+"/chatly/chat/completions",S=(0,i.createContext)({messages:[],error:void 0,append:async()=>null,continueMessage:async()=>null,reload:async()=>null,stop:async()=>null,setMessages:()=>null,metadata:{},isLoading:!1}),y=e=>{var t;let{children:n}=e,l=(0,r.useParams)(),{model:s}=(0,T.Td)()(e=>e.imagineBotConfig),o=function(e){let{api:t="/api/chat",id:n,initialMessages:a,onResponse:r,onFinish:l,onError:s,interceptor:o,headers:d,body:g,maxTokens:p=250}=e,h=(0,i.useId)(),_=null!=n?n:h,f="string"==typeof t?[t,_]:_,[x]=(0,i.useState)([]),{data:v,mutate:I}=(0,c.ZP)([f,"messages"],null,{fallbackData:null!=a?a:x});(0,i.useEffect)(()=>{I(null!=a?a:x,!1)},[]);let{data:T=!1,mutate:w}=(0,c.ZP)([f,"loading"],null),{data:j,mutate:S}=(0,c.ZP)([f,"streamData"],null),{data:y,mutate:N}=(0,c.ZP)([f,"error"],null),A=(0,i.useRef)(v||[]);(0,i.useEffect)(()=>{A.current=v||[]},[v]);let O=(0,i.useRef)(new AbortController),C=(0,i.useRef)({headers:d,body:g});(0,i.useEffect)(()=>{C.current={headers:d,body:g}},[d,g]);let R=(0,i.useCallback)(async function(e){let{shouldContinue:n,shouldCallCaptionApi:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shouldContinue:!1,shouldCallCaptionApi:!1};try{await w(!0),await N(void 0),O.current.signal.aborted&&(O.current=new AbortController),a?await E({chatRequest:e,mutate:I}):await b({api:t,chatRequest:e,mutate:I,mutateStreamData:S,existingData:j,extraMetadataRef:C,messagesRef:A,abortControllerRef:O,interceptor:o,onFinish:l,onResponse:r,shouldContinue:n,maxTokens:p})}catch(e){if("AbortError"===e.name)return null;s&&e instanceof Error&&s(e),await N(e)}finally{await w(!1)}},[I,w,t,C,r,l,s,N,S,j,A,O,o,p]),P=(0,i.useCallback)(async function(e){let{options:t,data:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.id||(e.id=(0,m.O)());let a=e.role===u.X.USER&&!!e.image;return R({messages:A.current.concat(e),options:t,data:n},{shouldCallCaptionApi:a})},[R]),M=(0,i.useCallback)(async function(){let{options:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===A.current.length?null:R({messages:A.current,options:e},{shouldContinue:!0})},[R]),G=(0,i.useCallback)(async function(){let{options:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===A.current.length?null:"system"===A.current[A.current.length-1].role?R({messages:A.current.slice(0,-1),options:e}):R({messages:A.current,options:e})},[R]),k=(0,i.useCallback)(()=>{O.current.abort()},[]),L=(0,i.useCallback)(e=>{I(e,!1),A.current=e},[I]);return(0,i.useEffect)(()=>{k()},[n,k]),{messages:v||[],error:y,append:P,continueMessage:M,reload:G,stop:k,setMessages:L,isLoading:T,data:j}}({id:null==l?void 0:null===(t=l.id)||void 0===t?void 0:t.toString(),api:j,headers:{Authorization:(0,w.Oj)()},initialMessages:[{id:(0,m.O)(),role:"system",content:s.intent,model:s.id}],maxTokens:s.max_tokens});return(0,a.jsx)(S.Provider,{value:o,children:n})},N=()=>{let e=(0,i.useContext)(S);if(void 0===e)throw Error("useChatContext must be used within a ChatProvider");return e}},10420:function(e,t,n){n.d(t,{TextToImageFormProvider:function(){return _},s:function(){return f}});var a=n(57437),r=n(31014),i=n(2265),l=n(39343),s=n(43897),o=n(23045),c=n(10733),d=n(91606),u=n(82074),m=n(47802);let g=e=>{let t=(0,d.O_)(),n=(0,u.p)(e=>e.persistedTextToImageSetting);return(0,i.useEffect)(()=>{if(!t||!n)return;let a=(0,m.ER)();a?e.reset({...n,prompt:a}):e.reset({...n})},[t,e]),null};var p=n(16463);let h=e=>{let t=(0,d.O_)(),n=(0,p.useSearchParams)(),{textToImage:{prompt:a,num_images:r,aspect_ratio:l,tags:u,strength_mode:g,styleListId:h,modelListId:_,controlListId:f}}=(0,c.Td)()(e=>e.defaultSettings),x=(0,c.Td)()(e=>e.textToImageSviImageGuidance),v=n.get(o.xi.PROMPT),I=null!=v?v:a,E=n.get(o.xi.NUM_IMAGES),b=(0,m.X7)(null!=E?E:"",r),T=n.get(o.xi.ASPECT_RATIO),w=null!=T?T:l,j=n.get(o.xi.TRANSPARENCY),S="true"===j,y=n.get(o.xi.TAGS),N=JSON.parse(null!=y?y:JSON.stringify(u)),A=n.get(o.xi.STRENGTH_MODE),O=null!=A?A:g,C=n.get(o.xi.MODEL_LIST_ID),R=(0,s.ic)((0,m.X7)(null!=C?C:"",_)),P=n.get(o.xi.STYLE_LIST_ID),M=(0,s.l$)((0,m.X7)(null!=P?P:"",h)),G=n.get(o.xi.CONTROL_LIST_ID),k=(0,s.$I)((0,m.X7)(null!=G?G:"",f));return(0,i.useEffect)(()=>{t&&(P&&e.setValue(o.xi.STYLE,M),C&&e.setValue(o.xi.MODEL,R),null!==v&&e.setValue(o.xi.PROMPT,I),E&&e.setValue(o.xi.NUM_IMAGES,b),T&&e.setValue(o.xi.ASPECT_RATIO,w),j&&e.setValue(o.xi.TRANSPARENCY,S),y&&e.setValue(o.xi.TAGS,N),(A||G)&&e.setValue(o.xi.IMAGE_GUIDANCE,{...x,strength_mode:O,image:null,croppedImage:null,mode:k.parameter}))},[e,t]),null},_=e=>{let{children:t}=e,{textToImage:n}=(0,c.Td)()(e=>e.defaultSettings),{strength_mode:i,modelListId:d,styleListId:u,controlListId:m,...p}=n,_=(0,s.ic)(d),f=(0,s.l$)(u),x=(0,s.$I)(m),v=(0,c.Td)()(e=>e.textToImageSviImageGuidance),I=(0,l.cI)({mode:"onChange",resolver:(0,r.F)(o.xG),defaultValues:{...p,model:_,style:f,image_guidance:{...v,mode:x.parameter,strength_mode:i},random_prompt_clicked:!1}});return g(I),h(I),(0,a.jsx)(l.RV,{...I,children:t})},f=()=>{let e=(0,l.Gc)();return(0,i.useMemo)(()=>({formHook:e}),[e])}},39082:function(e,t,n){n.d(t,{m:function(){return m},w:function(){return u}});var a=n(57437),r=n(31014),i=n(2265),l=n(39343),s=n(2753),o=n(85546),c=n(10733);let d=(0,i.createContext)(null),u=e=>{let{children:t}=e,{videoGeneration:{describeVideo:n,animateImage:u}}=(0,c.Td)()(e=>e.defaultSettings),m=(0,l.cI)({resolver:(0,r.F)(o.M0),defaultValues:{...n,is_face_detected:!1,random_prompt_clicked:!1},mode:"onChange"}),g=(0,l.cI)({resolver:(0,r.F)(s.B),defaultValues:{...u,recreate_button_clicked:!1},mode:"onChange"}),p=(0,i.useMemo)(()=>({textImageToVideoFormHook:m,animateImageFormHook:g}),[m,g]);return(0,a.jsx)(d.Provider,{value:p,children:t})},m=()=>{let e=(0,i.useContext)(d);if(!e)throw Error("useVideoGenerationFormContext must be used within a VideoGenerationFormProvider");return e}},88594:function(e,t,n){n.d(t,{TextToImage:function(){return t_}});var a,r,i,l,s=n(57437),o=n(2265),c=n(52247),d=n(80732),u=n(25701),m=n(41926),g=n(96994),p=n(10420),h=n(62372),_=n(39082),f=n(73558),x=n(31014),v=n(39343),I=n(59772),E=n(83231);(a=i||(i={})).PROMPT="prompt",a.IMAGE="image",a.CROPPED_IMAGE="croppedImage";let b=I.z.object({prompt:E.Pp.optional(),image:E.KA.optional(),croppedImage:E.KA.optional()}),T=e=>{let{children:t}=e,n=(0,v.cI)({resolver:(0,x.F)(b),defaultValues:{prompt:"",image:null,croppedImage:null}});return(0,s.jsx)(v.RV,{...n,children:t})},w=()=>{let e=(0,v.Gc)();if(!e)throw Error("useImagineBotFormContext must be used within a ImagineBotFormProvider");return(0,o.useMemo)(()=>({formHook:e}),[e])};var j=n(27271);let S=(0,n(39099).Ue)(e=>({isOpen:!1,setIsOpen:t=>e({isOpen:t}),open:()=>e({isOpen:!0}),toggleOpen:()=>e(e=>({isOpen:!e.isOpen}))}));var y=n(47802),N=n(8443),A=n(45331),O=n(24528),C=n(91606);let R=e=>{let{text:t,onStart:n=()=>{},onComplete:a=()=>{}}=e,[r,i]=(0,o.useState)(""),[l,s]=(0,o.useState)(0);return(0,o.useEffect)(()=>{if(l<t.length){n();let e=setTimeout(()=>{i(e=>e+t[l]),s(e=>e+1)},10);return()=>clearTimeout(e)}return a(),()=>{}},[l,t]),r},P=e=>{let{className:t}=e;return(0,s.jsx)("svg",{width:"30",height:"30",fill:"none",viewBox:"0 0 30 30",className:t,children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.417 3.751c.575 0 1.042.467 1.042 1.042V8.96H17.708c1.739 0 2.863-.001 3.807.306a6.25 6.25 0 0 1 4.013 4.012c.307.944.306 2.069.306 3.807v.416c0 1.739 0 2.863-.306 3.807a6.25 6.25 0 0 1-4.013 4.012c-.944.307-2.068.307-3.807.306h-4.582c-1.739.001-2.863.001-3.807-.306a6.25 6.25 0 0 1-4.013-4.012C5 20.364 5 19.24 5.001 17.5a708.096 708.096 0 0 0 0-.416c0-1.738-.001-2.863.305-3.807A6.25 6.25 0 0 1 9.32 9.266c.944-.307 2.068-.307 3.807-.306h1.25V4.793c0-.575.466-1.042 1.041-1.042Zm-2.083 7.292c-2.02 0-2.783.013-3.371.204a4.166 4.166 0 0 0-2.675 2.675c-.191.588-.204 1.351-.204 3.371s.013 2.783.204 3.371a4.167 4.167 0 0 0 2.675 2.675c.588.191 1.351.204 3.37.204H17.5c2.02 0 2.783-.013 3.372-.204a4.167 4.167 0 0 0 2.675-2.675c.19-.588.203-1.351.203-3.37 0-2.02-.012-2.784-.203-3.372a4.167 4.167 0 0 0-2.675-2.675c-.589-.191-1.352-.204-3.372-.204h-4.166Zm-3.125 5.209a2.083 2.083 0 1 1 4.166 0 2.083 2.083 0 0 1-4.166 0Zm6.25 0a2.083 2.083 0 1 1 4.167 0 2.083 2.083 0 0 1-4.167 0Z",fill:"currentColor"})})};var M=n(29352),G=n(53980),k=n(83599),L=n(1639),D=n(30653),z=n(81149),V=n(83965),F=n(8792);let U=e=>{let{language:t,code:n}=e,[,a]=(0,C.m9)(),[r,i]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(r){let e=setTimeout(()=>{i(!1)},3e3);return()=>clearTimeout(e)}return()=>{}},[r]),(0,s.jsxs)("div",{className:"bg-surface text-caption text-secondary flex w-full max-w-[588px] items-center justify-between rounded-t-xl p-4 font-medium transition-all duration-500",children:[(0,s.jsx)("p",{className:"text-caption font-medium",children:t}),r?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(V.K,{className:"size-4"}),(0,s.jsx)("span",{className:"",children:"Copied!"})]}):(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(z.z,{variant:"ghost-secondary",size:"icon-sm",className:"size-4 p-0",onClick:()=>{i(!0),a(n)},children:(0,s.jsx)(F.TI,{className:"size-4"})}),(0,s.jsx)("span",{children:"Copy code"})]})]})},B={h1:e=>{let{children:t,...n}=e;return(0,s.jsx)("h1",{...n,className:"mb-2 text-4xl font-semibold",children:t})},h2:e=>{let{children:t,...n}=e;return(0,s.jsx)("h2",{...n,className:"mb-2 text-2xl font-semibold",children:t})},h3:e=>{let{children:t,...n}=e;return(0,s.jsx)("h3",{...n,className:"mb-2 text-xl font-semibold",children:t})},h4:e=>{let{children:t,...n}=e;return(0,s.jsx)("h4",{...n,className:"mb-2 text-base font-semibold",children:t})},h5:e=>{let{children:t,...n}=e;return(0,s.jsx)("h5",{...n,className:"mb-2 text-base font-semibold",children:t})},h6:e=>{let{children:t,...n}=e;return(0,s.jsx)("h6",{...n,className:"mb-2 text-base font-normal",children:t})},p:e=>{let{children:t,className:n,...a}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{...a,className:(0,O.cn)(n,"inline text-sm font-normal"),children:t}),(0,s.jsx)("div",{className:"mb-2"})]})},pre:e=>{let{children:t,className:n,...a}=e;return(0,s.jsx)("pre",{...a,className:(0,O.cn)(n,"mb-3 w-full text-sm"),children:t})},em:e=>{let{children:t,...n}=e;return(0,s.jsx)("em",{...n,className:"text-sm font-normal italic",children:t})},strong:e=>{let{children:t,...n}=e;return(0,s.jsx)("strong",{...n,className:"text-sm font-bold",children:t})},code(e){let{node:t,className:n,children:a,...r}=e,i=/language-(\w+)/.exec(n||""),l=String(a).replace(/\n$/,"");return i?(0,s.jsxs)("div",{className:"flex w-full max-w-[350px] flex-col items-center gap-0",children:[(0,s.jsx)(U,{language:i[1],code:l}),(0,s.jsx)(L.Z,{customStyle:{margin:0,width:"100%",backgroundColor:"#000000"},className:"rounded-b-xl",style:D.Z,language:i[1],wrapLines:!0,children:l})]}):(0,s.jsx)("code",{...r,className:n,children:a})},ul:e=>{let{children:t,className:n,...a}=e;return(0,s.jsx)("ul",{...a,className:(0,O.cn)(n,"mb-2 flex list-inside list-disc flex-col gap-2"),children:t})},ol:e=>{let{children:t,className:n,...a}=e;return(0,s.jsx)("ol",{...a,className:(0,O.cn)(n,"mb-2 flex list-inside list-decimal flex-col gap-2 [&_li_p]:ml-1"),children:t})},li:e=>{let{children:t,className:n,...a}=e;return(0,s.jsx)("li",{...a,className:(0,O.cn)(n,"text-base font-normal"),children:t})},a:e=>{let{children:t,...n}=e;return(0,s.jsx)("a",{...n,className:"hover:text-brand-hover text-base text-primary-500 transition-all duration-500 hover:underline",children:t})}},H=e=>{let{sender:t,content:n,image:a}=e,r=t===A.X.USER,i=t===A.X.SYSTEM,l=!!a;return r&&l?(0,s.jsx)("div",{className:"flex items-center justify-center rounded-2xl bg-neutral-30 p-2 dark:bg-neutral-700",children:(0,s.jsx)("img",{src:a,alt:"User uploaded",className:"aspect-square h-full w-[200px] rounded-lg object-contain"})}):i?(0,s.jsx)("div",{className:"flex w-[235px] items-start self-stretch p-3",children:(0,s.jsx)(M.D,{remarkPlugins:[k.Z],rehypePlugins:[G.Z],components:B,className:"w-full",children:n})}):(0,s.jsx)("div",{className:"flex max-w-[270px] items-center self-stretch rounded-2xl bg-neutral-30 px-3.5 py-2.5 dark:bg-neutral-700",children:(0,s.jsx)("div",{className:"w-full max-w-[270px] overflow-auto text-wrap break-words",children:(0,s.jsx)("p",{className:"text-sm text-neutral-900 dark:text-neutral-0",children:n})})})};var K=n(55872);let X=e=>{let{handleCopy:t,handleGenerate:n=()=>{},credits:a=0}=e;return(0,s.jsxs)("div",{className:"flex items-center justify-between self-stretch border-t border-neutral-30 px-3 py-2 dark:border-neutral-700",children:[(0,s.jsxs)(K.D,{isLoading:!1,children:[(0,s.jsx)(K.D.Button,{btnText:"Generate",credits:a,onClick:n}),(0,s.jsx)(K.D.Cancel,{handleCancel:()=>{}})]}),(0,s.jsx)(z.z,{variant:"ghost-secondary",size:"icon-xl",onClick:t,children:(0,s.jsx)(F.TI,{className:"size-6 stroke-[2]"})})]})},Y=()=>(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2.5 rounded-lg p-3 ring-1 ring-neutral-30 dark:ring-neutral-700",children:[(0,s.jsx)("span",{className:"size-1 animate-ping rounded-full bg-neutral-60 [animation-duration:1.5s] dark:bg-neutral-600"}),(0,s.jsx)("span",{className:"size-1 animate-ping rounded-full bg-neutral-60 [animation-duration:1.5s] [animation-delay:100ms] dark:bg-neutral-600"}),(0,s.jsx)("span",{className:"size-1 animate-ping rounded-full bg-neutral-60 [animation-duration:1.5s] [animation-delay:200ms] dark:bg-neutral-600"}),(0,s.jsx)("span",{className:"size-1 animate-ping rounded-full bg-neutral-60 [animation-duration:1.5s] [animation-delay:300ms] dark:bg-neutral-600"})]}),$=e=>{let{image:t,sender:n,content:a,credits:r,handleGenerate:i=()=>{},showPromptCTAs:l=!0,showLoading:o=!1}=e,[,c]=(0,C.m9)(),d=n===A.X.USER,u=n===A.X.SYSTEM;return(0,s.jsx)("div",{className:(0,O.cn)("flex w-full max-w-[366px] items-start gap-3",{"justify-end":d,"justify-start":u}),children:d?(0,s.jsx)(H,{sender:n,image:t,content:a}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex size-[30px] items-center justify-center rounded-xl bg-neutral-900 text-neutral-0 dark:bg-neutral-0 dark:text-neutral-900",children:(0,s.jsx)(P,{className:"size-4/5"})}),o?(0,s.jsx)(Y,{}):(0,s.jsxs)("div",{className:"flex w-[283px] flex-col items-start rounded-2xl ring-1 ring-neutral-30 dark:ring-neutral-700",children:[(0,s.jsx)(H,{sender:n,image:t,content:a}),l&&(0,s.jsx)(X,{handleCopy:()=>{c(a)},credits:r,handleGenerate:()=>i(a)})]})]})})},W=e=>(0,s.jsx)($,{...e}),Z=e=>{let{content:t,onStart:n,onComplete:a,...r}=e,i=R({text:t,onStart:n,onComplete:a});return(0,s.jsx)($,{content:i,...r})};Z.displayName="ChatMessageWithTypewriter",$.displayName="ChatMessageRoot",W.displayName="ChatMessageDefault";let q={Default:W,Typewriter:Z};var J=e=>{let{messages:t,isLoading:n=!1,handleGenerate:a,credits:r}=e,[i,l]=(0,o.useState)(!1),c=(0,o.useRef)(t.length),d=(0,o.useRef)(null),u=(0,o.useRef)(!1);return(0,o.useEffect)(()=>{if(!u.current){var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"instant"}),u.current=!0}},[]),(0,o.useEffect)(()=>{if(u.current){var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}},[t]),(0,o.useEffect)(()=>{let e;if(u.current){if(i)e=setInterval(()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},500);else{var t;null===(t=d.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})}}return()=>{clearTimeout(e)}},[i]),(0,s.jsxs)("div",{className:(0,O.cn)("flex flex-col items-end gap-4 self-stretch"),children:[t.map((e,n)=>{let o=e.role===A.X.SYSTEM,d=n===t.length-1&&o,u=!!e.image,m=d&&!u&&t.length>c.current;return 0===n?null:m?(0,s.jsx)(q.Typewriter,{content:e.content,sender:e.role,onStart:()=>{l(!0)},onComplete:()=>{l(!1)},showPromptCTAs:!i,credits:r,handleGenerate:a},e.id):o?(0,s.jsx)(q.Default,{sender:e.role,content:e.content,handleGenerate:a,credits:r,showPromptCTAs:!0},e.id):(0,s.jsx)(q.Default,{sender:e.role,content:e.content,image:e.image},e.id)}),n&&(0,s.jsx)(q.Default,{sender:A.X.SYSTEM,showPromptCTAs:!1,showLoading:!0,content:""}),(0,s.jsx)("div",{ref:d})]})},Q=n(16463),ee=n(63218),et=n(9938),en=n(10733),ea=n(81750);let er=e=>{let{title:t,intent:n,onClick:a}=e;return(0,s.jsx)("button",{type:"button",className:"flex h-[70px] w-[160px] shrink-0 items-center gap-2 rounded-xl px-3 py-1.5 text-left text-xs/[18px] font-medium text-neutral-900 ring-1 ring-neutral-30 transition-colors duration-300 hover:bg-neutral-20 active:bg-neutral-20 dark:text-neutral-0 dark:ring-neutral-700 dark:hover:bg-neutral-800 dark:active:bg-neutral-800",onClick:()=>a(n),children:t})},ei=(e,t)=>{let n=[...e];for(let e=n.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[n[e],n[t]]=[n[t],n[e]]}return n.slice(0,t)},el=()=>{let{presets:e,model:t}=(0,en.Td)()(e=>e.imagineBotConfig),n=!!(0,ea.m8)()(e=>e.user),a=(0,Q.usePathname)(),r=(0,Q.useRouter)(),{append:i}=(0,N.m)(),l=(0,o.useMemo)(()=>ei(e,4),[e]),c=e=>{if(!n){r.push("".concat(ee.H7.TOOLS_AUTH,"?redirect=").concat(a));return}i({id:(0,et.O)(),model:t.id,content:e,role:A.X.USER})};return(0,s.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-3",children:l.map(e=>(0,s.jsx)(er,{title:e.title,intent:e.intent,onClick:()=>c(e.intent)},e.title))})},es=()=>(0,s.jsxs)("div",{className:"flex flex-col items-center gap-6 self-stretch",children:[(0,s.jsx)("div",{className:"flex size-12 items-center justify-center rounded-2xl bg-primary-500 text-neutral-0",children:(0,s.jsx)(P,{})}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 self-stretch transition-colors duration-300",children:[(0,s.jsx)("h4",{className:"font-semibold text-neutral-900 dark:text-neutral-0",children:"Imagine Bot"}),(0,s.jsx)("p",{className:"text-center text-sm text-neutral-600 dark:text-neutral-60",children:"Spark your creativity with Imagine Bot! Generate unique prompts to inspire your next visual masterpiece."})]})]}),eo=()=>{let{formHook:e}=w(),t=(0,v.qo)({control:e.control,name:"image"});return(0,s.jsxs)("div",{className:"flex flex-1 flex-col items-start gap-6 self-stretch",children:[(0,s.jsx)(es,{}),!t&&(0,s.jsx)(el,{})]})},ec=e=>{let{handleGenerateImage:t,credits:n}=e,{messages:a,isLoading:r}=(0,N.m)();return 1===a.length?(0,s.jsx)(eo,{}):(0,s.jsx)(J,{isLoading:r,messages:a,handleGenerate:t,credits:n})},ed=e=>{let{title:t}=e;return(0,s.jsx)("div",{className:"flex shrink-0 items-center self-stretch border-b border-neutral-20 p-4 dark:border-neutral-800",children:(0,s.jsx)("h4",{className:"font-semibold text-neutral-900 dark:text-neutral-0",children:t})})},eu=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"scrollbar__alt flex flex-1 flex-col items-center justify-between self-stretch overflow-auto px-4 pt-8",children:t})},em=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"shrink-0 border-t border-neutral-20 p-4 pt-2.5 dark:border-neutral-800",children:t})};ed.displayName="ImagineBotLayoutHeader",eu.displayName="ImagineBotLayoutBody",em.displayName="ImagineBotLayoutFooter";var eg=n(69608),ep=n(82442),eh=n(28926),e_=n(27424),ef=n(8127);let ex=m.TOOLS_SETTINGS.ASPECT_RATIO_SVI.content,ev=e=>{let{hide:t=!1}=e,{formHook:n}=w(),a=(0,v.qo)({control:n.control,name:"image"}),r=(0,v.qo)({control:n.control,name:"croppedImage"}),l=async e=>{let t=await (0,ef.ug)(e),a=(0,ef.RJ)(t);n.setValue(i.IMAGE,a),n.setValue(i.CROPPED_IMAGE,a)};return(0,s.jsx)(eh.Q,{activeTool:e_.X.TextToImageV2,aspectRatios:Object.values(ex),uploadImgPromptVariant:"icon",uploadImgPromptSize:"icon",modalContainer:null,handleAddImage:l,currentImage:r,handleDeleteImage:()=>{n.setValue(i.IMAGE,null),n.setValue(i.CROPPED_IMAGE,null)},imageCroppedFrom:a,selectedImagePromptVariant:"v2",selectedImageClassName:"dark:bg-neutral-700 bg-neutral-30 h-[192px] rounded-2xl",showCropButton:!1,uploadImgPromptClassName:(0,O.cn)("mr-2",{"w-0 transition-all duration-300 h-0 opacity-0 scale-0 mr-0":t})})};var eI=n(1255);let eE=e=>{let{onFocus:t=()=>{},onBlur:n=()=>{}}=e,{formHook:a}=w(),r=e=>{if("Enter"===e.key&&!e.shiftKey){var t,n;e.preventDefault(),null===(n=e.currentTarget)||void 0===n||null===(t=n.form)||void 0===t||t.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))}};return(0,s.jsx)(v.Qr,{control:a.control,name:"prompt",render:e=>{let{field:{ref:a,onBlur:i,...l}}=e;return(0,s.jsx)(eI.Z,{placeholder:"Type your idea...",className:(0,O.cn)("w-full resize-none rounded-[10px] border-none bg-neutral-20 py-2.5 pl-3 pr-2 text-sm text-neutral-900 placeholder-neutral-200 ring-0 ring-primary-500 transition-all duration-300 hover:bg-neutral-30 focus:bg-neutral-20 focus:ring-1 dark:bg-neutral-800 dark:text-neutral-0 dark:placeholder-neutral-80 dark:ring-primary-400 dark:hover:bg-neutral-700 dark:focus:bg-neutral-800"),minRows:1,maxRows:4,ref:a,onKeyDown:r,onBlur:()=>{i(),n()},onFocus:t,autoFocus:!1,...l})}})},eb=()=>{let[e,t]=(0,o.useState)(!1),{formHook:n}=w(),{model:a}=(0,en.Td)()(e=>e.imagineBotConfig),r=(0,Q.usePathname)(),l=(0,Q.useRouter)(),{append:c,isLoading:d}=(0,N.m)(),u=!!(0,ea.m8)()(e=>e.user),m=(0,v.qo)({control:n.control,name:"image"}),g=(0,v.qo)({control:n.control,name:"prompt"});return(0,s.jsxs)("form",{className:"flex flex-1 items-center justify-center",onSubmit:n.handleSubmit(e=>{if(!u){l.push("".concat(ee.H7.TOOLS_AUTH,"?redirect=").concat(r));return}if(!e[i.PROMPT]&&!e[i.IMAGE]){ep.Am.error("Please enter a prompt or an image");return}c({id:(0,et.O)(),role:A.X.USER,content:e.prompt||"",model:a.id,image:e.image||""}),n.reset()}),children:[!g&&(0,s.jsx)(ev,{hide:e}),!m&&(0,s.jsx)(eE,{onFocus:()=>{t(!0)},onBlur:()=>{t(!1)}}),(0,s.jsx)(z.z,{type:"submit",variant:"primary",size:"icon-xl",className:"ml-2 shrink-0 disabled:bg-neutral-700 disabled:text-neutral-0",disabled:!m&&!g&&d,children:(0,s.jsx)(eg.Rr,{className:"size-6 stroke-[1.5]"})})]})};var eT=n(12835),ew=n(95401);let ej=o.forwardRef((e,t)=>{let{toggleOpen:n,isOpen:a}=S(e=>({toggleOpen:e.toggleOpen,isOpen:e.isOpen}));return(0,s.jsx)(z.z,{...e,type:"button",ref:t,variant:"none",size:"none",className:(0,O.cn)("fixed bottom-4 right-4 active:translate-y-0"),onClick:n,children:(0,s.jsx)(ew.WithGenericTooltip,{content:"Imagine Bot",genericTooltipProps:{open:!a&&void 0},children:(0,s.jsxs)("div",{className:"flex size-[60px] items-center justify-center rounded-[20px] bg-neutral-0 p-4 shadow-[0px_10px_20px_0px_rgba(0,0,0,0.08)] transition-transform duration-300 hover:scale-[1.06] active:scale-[0.8] dark:bg-neutral-900",children:[(0,s.jsx)(P,{className:(0,O.cn)("absolute size-[30px] opacity-100 transition-all duration-300",{"rotate-180 scale-0 opacity-0":a})}),(0,s.jsx)(eT.KQ,{className:(0,O.cn)("absolute size-[30px] opacity-0 transition-all duration-300",{"rotate-180 opacity-100":a})})]})})})});ej.displayName="ImagineBotTriggerCTA";let eS=[".text-to-image-sidebar",".text-to-image-models",".text-to-image-styles",".text-to-image-aspect-ratio",".text-to-image-guidance-modes"],ey=e=>{let{handleGenerateImage:t,credits:n}=e,{isOpen:a,setIsOpen:r}=S(e=>({isOpen:e.isOpen,setIsOpen:e.setIsOpen}));return(0,s.jsxs)(j.A6,{open:a,onOpenChange:r,children:[(0,s.jsx)(j.mu,{asChild:!0,children:(0,s.jsx)(ej,{})}),(0,s.jsxs)(j.nE,{className:"z-[1000] flex h-[560px] w-[400px] flex-col rounded-2xl",align:"end",side:"top",sideOffset:8,onInteractOutside:e=>{eS.some(t=>(0,y.Ni)(e,t))&&e.preventDefault()},children:[(0,s.jsx)(ed,{title:"Imagine Bot"}),(0,s.jsx)(eu,{children:(0,s.jsx)(ec,{handleGenerateImage:t,credits:n})}),(0,s.jsx)(em,{children:(0,s.jsx)(eb,{})})]})]})},eN=e=>{let{credits:t,handleGenerateImage:n}=e;return(0,s.jsx)(T,{children:(0,s.jsx)(f.h,{children:(0,s.jsx)(ey,{credits:t,handleGenerateImage:n})})})};var eA=n(6498),eO=n(54795),eC=n(72811);let eR=()=>{var e;let{formHook:t}=(0,p.s)(),{isLoading:n,data:a}=(0,eA.X)(),r=0;if(n)return{cost:r};let i=null==a?void 0:a[eO.TG.FROM_TEXT];if(!i)return{cost:r};let{criteria:l}=i,s=t.watch("model"),o=t.watch("num_images");return{cost:(r+=(0,eC.l)(l,s)+(null!==(e=i.base)&&void 0!==e?e:0))*o}};var eP=n(89565),eM=n(72143),eG=n(97157);(r=l||(l={})).TEXT_TO_IMAGE="txt2img",r.IMAGE_TO_IMAGE="img2img";let ek=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.4;return e?"(".concat(e.trim(),":").concat(t,")"):""},eL=(e,t)=>{let n=t.match(/^\w+\s+\w+/),a=t.match(/(\w+\s+\w+)\W*$/);if(!n||!a||!n.length||!a.length)return e;let r=n[0].replace(/^\W+|\W+$/gm,""),i=a[0].replace(/^\W+|\W+$/gm,""),l=e.indexOf(r),s=e.lastIndexOf(i);if(-1===l||-1===s)return e;let o=e.substring(l,s+i.length),c=e.substring(0,l),d=e.substring(s+i.length).replace(/\.$/g,"");return"".concat(ek(c),' "').concat(o,'" ').concat(ek(d)).trim()},eD=async e=>{let t=e.image_guidance.croppedImage,n=e.image_guidance,a=e.image_guidance.mode,r=e.image_guidance.strength_mode,i={};if(!t||e.model.is_image_guidance_disabled)return i;if(!a||!r)throw Error("Invalid control mode or strength mode");switch(a){case eG.e.STRUCTURE:{let e=n[a],l=e.strength[r];i.control_1_image=await (0,ef.K$)(t),i.control_1_type=e.control_1_type,i.control_1_weight=l,i.variation=e.variation;break}case eG.e.BASE:{let e=n[a],l=e.strength[r];i.image=await (0,ef.K$)(t),i.variation=e.variation,i.denoising_strength=l;break}case eG.e.FACE:{let e=n[a],l=e.strength[r];i.face=await (0,ef.K$)(t),i.variation=e.variation,i.face_strength=l;break}case eG.e.STYLE:{let e=n[a],l=e.strength[r];i.style_image=await (0,ef.K$)(t),i.variation=e.variation,i.style_strength=l}}return i},ez=async(e,t,n)=>{var a,r,i,l;let s=e.image_guidance.base.image_caption||"",o=(null===(a=e.style)||void 0===a?void 0:a.tag)?"<effect>".concat(null===(r=e.style)||void 0===r?void 0:r.tag,"</effect>"):"",c=Object.entries(e.tags).flatMap(e=>Array.from(e[1])),d=eL(e.prompt,s),u=(0,eO.SN)(d,null===(i=e.model)||void 0===i?void 0:i.init_prompt,...c),m={prompt:u?u+o:"",style_id:e.model.model_id,aspect_ratio:e.aspect_ratio,variation:t};if("img2img"===t&&n)m.denoising_strength=null!==(l=e.denoising_strength)&&void 0!==l?l:.6,m.image=await (0,ef.K$)(n);else{let t=await eD(e);m={...m,...t}}return(0,y.wh)(m)},eV=new AbortController,eF=async(e,t,n,a)=>{eV.signal.aborted&&(eV=new AbortController);let r=(0,eO.kw)(t);r.append("Style-Id","".concat(e.model.model_id)),c.v.IS_PROD_DEPLOYMENT||r.append("X-Internal","developer_mode");let i=await ez(e,n,a),{data:l}=await eM.p.post(eO.TG.FROM_TEXT,{body:i,headers:r,signal:eV.signal},{throwOnError:!0});return{src:(0,ef.RJ)(l)}},eU=()=>{eV.abort()},eB=e=>{let t=(0,eP.useMutation)(t=>eF(t.data,t.isPremium,e,t.imageForVariation));return Object.assign(t,{cancelRequest:()=>{t.isLoading&&eU()}})};var eH=n(85951),eK=n(67259);let eX=()=>!1,eY=(0,eK.hB)(eX);(0,eK.hB)(eX);var e$=n(24827),eW=n(14125),eZ=n(29328);let eq=e=>{var t,n,a,r,i;let{generateTextToImageMutation:l,isPremium:s}=e,c=(0,Q.useRouter)(),m=(0,Q.usePathname)(),h=(0,ea.m8)()(e=>e.user),{formHook:_}=(0,p.s)(),{aggregator:f}=(0,eH.O)(),{page:x,source:v}=(0,g.V)(),I=(0,o.useRef)(0),E=eY(e=>e.completeImageGenerationLoadingOnGivenCollection),b=eY(e=>e.deleteLoadingImageFromGivenCollection),T=eY(e=>e.addImageToGivenCollectionWithLoading),w=eY(e=>e.createCollectionWithSettings),j=eY(e=>e.collections),S=(0,ea.m8)()(e=>e.subscription),y=(0,eW.L)(S),N=null===(a=y.stripeSubscription)||void 0===a?void 0:null===(n=a.StripePrice)||void 0===n?void 0:null===(t=n.StripeProduct)||void 0===t?void 0:t.name,A=null===(i=y.stripeSubscription)||void 0===i?void 0:null===(r=i.StripePrice)||void 0===r?void 0:r.billingInterval,O=y.isSubscriptionActive?"Premium":"Free",{cost:C}=eR(),{data:R}=(0,eA.j)(),P=(null==R?void 0:R.platformSpecificTotal)?R.platformSpecificTotal-C:0,M=async(e,t)=>{let n=T(t);try{let a=await l.mutateAsync({data:e,isPremium:s});if(!a)throw Error("Processing stopped");return E({image:a,imageId:n.imageId,collectionId:t}),{isSuccess:!0}}catch(e){return b({imageId:n.imageId,collectionId:t}),(0,eZ.eL)(e,s),{isSuccess:!1,error:e}}},G=async(e,t)=>{let n=await Promise.all(Array.from({length:e.num_images}).map(()=>M(e,t)));return n.reduce((e,t)=>t.isSuccess?{...e,successCount:e.successCount+1}:{...e,failureCount:e.failureCount+1,error:t.error},{successCount:0,failureCount:0,totalCount:n.length,error:Error("Default")})};return async function(e){var t,n;let a,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.prompt){ep.Am.error("Please enter a prompt");return}if(!h){c.push("".concat(ee.H7.TOOLS_AUTH,"?redirect=").concat(m));return}if(new Set(j.flatMap(e=>e.images).filter(e=>e.isLoading).map(e=>e.id)).size+e.num_images>8){ep.Am.error("Maximum ".concat(8," concurrent images can be generated!"));return}let{collectionId:i}=w(e);setTimeout(()=>{var e;null===(e=document.getElementById(i))||void 0===e||e.scrollIntoView({behavior:"smooth"})});let l=await G(e,i),s=Object.values(e.tags).map(e=>Array.from(e)).flat().join(","),o=Object.entries(e.tags).filter(e=>{let[t,n]=e;return n.size>0}).map(e=>{let[t,n]=e;return t}).join(",");I.current+=e.num_images;let g={source:v,feature:u.L.TEXT_TO_IMAGE_V2,page_name:x,aspect_ratio:e.aspect_ratio,number_of_images:e.num_images,model_id:e.model.id,model_used:e.model.name,prompt_length:null===(t=e.prompt)||void 0===t?void 0:t.length,tag_used:s.length?s:"NA",tag_category:o.length?o:"NA",random_prompt_used:e.random_prompt_clicked,user_account_status:O,user_plan:N,user_plan_period:A,image_guidance:!!e.image_guidance.image,tokens_remaining:P};a=l.totalCount===l.successCount?{processing_status:"Successful"}:0===l.successCount?{processing_status:"Failure",processing_error:(0,eZ.t$)(l.error)}:{processing_status:"Partial",processing_error:(0,eZ.t$)(l.error)},f.log(d.H.mixpanel.image_generated.withProperties({...g,email:h.email,distinct_id:h.id,...a})),f.log(d.H.clevertap.image_generated.withProperties({...g,session_image_v2:I.current,upload_image:!!e.image_guidance.image,txt_v2_image_strength:e.image_guidance.strength_mode,txt_v2_image_mode:null!==(n=e.image_guidance.mode)&&void 0!==n?n:"",style_used:e.style.style_name,txt_v2_regeneration:r,...a})),_.setValue("random_prompt_clicked",!1)}},eJ=e=>{let{generateTextToImageMutation:t,isPremium:n}=e,a=eq({generateTextToImageMutation:t,isPremium:n}),{formHook:r}=(0,p.s)(),i=(0,Q.useSearchParams)(),l=(0,Q.usePathname)(),s=(0,Q.useRouter)(),c=(0,ea.m8)()(e=>e.user),d=i.get("generate"),u=r.getValues("prompt");return(0,o.useEffect)(()=>{if("true"===d&&u&&c){r.handleSubmit(e=>a(e))();let e=new URLSearchParams(window.location.search);e.delete("generate"),s.replace("".concat(l,"?").concat(e.toString()))}},[u,c,l]),null};var eQ=n(88327),e0=n(98090),e1=n(45715),e2=n(1576),e3=n(73359),e5=n(53514),e7=n(63930),e4=n(70244),e8=n(57552),e6=n(21803),e9=n(2753),te=n(69085),tt=n(79807),tn=n(16838),ta=n(63549),tr=n(31941);let ti=e=>{let{title:t,children:n,maxLength:a,tooltipContentProps:r}=e;return t.length>a?(0,s.jsx)(ew.WithGenericTooltip,{content:t,genericTooltipContentProps:{side:"top",align:"end",...r},children:n("".concat(t.slice(0,a-1),"..."))}):n(t)},tl=e=>{let{Icon:t,title:n,image:a,maxLength:r=15}=e;return(0,s.jsx)(ti,{title:n,maxLength:r,tooltipContentProps:{align:"center"},children:e=>(0,s.jsxs)("div",{className:(0,O.cn)("flex h-7 items-center gap-1 rounded-xl border border-neutral-30 p-1 pr-2 dark:border-neutral-600",{"gap-2":t}),children:[a&&(0,s.jsx)("img",{src:a,alt:e,className:"size-5 rounded-lg"}),t&&(0,s.jsx)(t,{className:"size-5"}),(0,s.jsx)("p",{className:"text-nowrap text-xs font-medium",children:e})]})})},ts=e=>{let{prompt:t,settingItems:n,handleDelete:a,isSettingItems:r,handleRegenerate:i,handleDownloadAll:l}=e,[,o]=(0,C.m9)();return(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(ti,{title:t,maxLength:70,children:e=>(0,s.jsx)("p",{className:"text-base font-medium",children:e})}),(0,s.jsx)(z.z,{size:"icon-sm",variant:"ghost-secondary",onClick:()=>{o(t).then(()=>ep.Am.success("Prompt copied to clipboard!"))},children:(0,s.jsx)(F.TI,{className:"size-[18px] stroke-[2]"})}),(0,s.jsx)(z.z,{size:"icon-sm",variant:"ghost-secondary",onClick:i,children:(0,s.jsx)(eT.BG,{className:"size-4"})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[r&&n.map(e=>(0,s.jsx)(tl,{...e},e.title)),(0,s.jsxs)(tr.z$,{modal:!1,children:[(0,s.jsx)(tr.pm,{asChild:!0,children:(0,s.jsx)(z.z,{size:"icon-sm",className:"h-8 p-0",variant:"ghost-secondary",children:(0,s.jsx)(eT.wz,{className:"size-[18px] shrink-0 stroke-[2]"})})}),(0,s.jsxs)(tr.Yy,{align:"end",position:"item-aligned",className:"min-w-[200px]",children:[(0,s.jsxs)(tr.KK,{className:"flex items-center justify-start",onClick:async()=>{await l()},children:[(0,s.jsx)(eT._8,{className:"mr-2 size-5"}),"Download All"]}),(0,s.jsxs)(tr.KK,{onClick:a,className:"flex items-center justify-start !text-error-500",children:[(0,s.jsx)(eT.XH,{className:"mr-2 size-5 text-error-500"}),"Delete"]})]})]})]})]})},to=e=>{let{isPremium:t,onFullView:n,collection:a,onRegenerate:r,onDeleteCollection:i,onAnimateImage:l,onEditImage:d,onRemoveBackground:u}=e,[g,p]=(0,o.useState)(!1),{exportAllImagesHandler:h}=(0,ta.P)({isSubscriptionActive:t,selectedCollection:a}),{openPopup:_,formId:f,formRef:x}=(0,e4.Z)({cookieKey:e2.R.SHOW_TEXT_FORM,darkModeFormId:e5._.TEXT_DARK_MODE,lightModeFormId:e5._.TEXT_LIGHT_MODE}),v=[{title:a.settings.aspect_ratio,Icon:(0,e$.o)(Object.values(m.TOOLS_SETTINGS.ASPECT_RATIO_SVI.content),null==a?void 0:a.settings.aspect_ratio)},{title:a.settings.model.name,image:"".concat(c.v.REMOTE_CONFIG_CDN).concat(a.settings.model.thumb)}],I=m.IK[a.settings.aspect_ratio],E=(e,t)=>{e&&(null==t||t({collectionId:a.id,imageId:e}))},b=e=>{r(e,!0)};return(0,s.jsxs)("div",{id:a.id,className:"flex flex-col gap-2 pb-4",onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[(0,s.jsx)(ts,{settingItems:v,prompt:a.settings.prompt,isSettingItems:g,handleDownloadAll:async()=>{await h(),_()},handleDelete:()=>i(a.id),handleRegenerate:()=>b(a.settings)}),(0,s.jsx)("div",{className:(0,O.cn)("grid gap-2",I.grid),children:a.images.map(e=>{var t;let a="isVariation"in e&&e.isVariation,r="isUpscaled"in e&&e.isUpscaled;return(0,s.jsxs)(tn.dk.Root,{id:e.id,image:null!==(t=e.upscaleSrc)&&void 0!==t?t:e.src,loaderVariant:"spinner",isLoading:e.isLoading,isFocused:e.isFocused,handleFullView:()=>E(e.id,n),className:(0,O.cn)(I.minH,I.aspectRatio),children:[(0,s.jsx)(tn.dk.ToolbarButtons,{image:e,handleFullView:()=>E(e.id,n),handleEditImage:()=>E(e.id,d),onDownload:_,handleRemoveBackground:()=>E(e.id,u),handleAnimateImage:()=>E(e.id,l)}),a&&(0,s.jsx)(tn.dk.HighlightLabel,{children:"Variation"}),!a&&r&&(0,s.jsx)(tn.dk.HighlightLabel,{children:"Upscaled"}),(0,s.jsx)(eQ.PopupButton,{id:f,style:{display:"none"},size:60,embedRef:x})]},e.id)})})]})},tc=e=>{var t,n,a,r,i;let{isPremium:l,submitHandler:c,useRequiredStore:m,isVariationSupported:p,getFullViewSettingItems:_,fullViewModalState:f,setFullViewModalState:x,closeFullViewModal:v,handleImageVariate:I}=e,[E,b]=(0,o.useState)(-1),{collections:T}=m(e=>e),w=m(e=>e.setImageLoadingOnGivenCollection),j=m(e=>e.setImageUpscaleOnGivenCollection),S=m(e=>e.deleteImageFromGivenCollection),y=m(e=>e.deleteGivenCollection),{enhance:N}=(0,en.Td)()(e=>e.defaultSettings),{setAnimateImageLoadingState:A,deleteStateAnimateImageLoadingState:O}=(0,h.kc)(),C=eY(e=>e.completeImageGenerationLoadingOnGivenCollection),R=eY(e=>e.addImageToGivenCollectionWithLoading),P=(0,e6.e)(),M=(0,e8.R)(),G=(0,Q.useRouter)(),{handleAnimateVideoGeneration:k}=(0,e7.I)(),L=(0,ea.m8)()(e=>e.subscription),{data:D}=(0,eA.j)(),z=(0,eW.L)(L),{aggregator:V}=(0,eH.O)(),{page:F,source:U}=(0,g.V)(),B=null===(a=z.stripeSubscription)||void 0===a?void 0:null===(n=a.StripePrice)||void 0===n?void 0:null===(t=n.StripeProduct)||void 0===t?void 0:t.name,H=null===(i=z.stripeSubscription)||void 0===i?void 0:null===(r=i.StripePrice)||void 0===r?void 0:r.billingInterval,K=z.isSubscriptionActive?"Premium":"Free",X=e=>{var t;let{collectionId:n,imageId:a}=e,r=T.findIndex(e=>e.id===n),i=null===(t=T[r])||void 0===t?void 0:t.images.findIndex(e=>e.id===a);b(r),x({isModalOpen:!0,initialImageIndex:i&&-1!==i?i:0})},Y=async e=>{var t;let n,{collectionId:a,imageId:r,upscaleConfig:i}=e;w(r,!0,a);let s=T.find(e=>e.id===a),o=null==s?void 0:s.images.find(e=>e.id===r);if(!o)throw Error("Image not found");let c={...N,...i,isPremium:l,originalImgSrc:o.src},m={feature:u.L.CREATIVE_ENHANCE,source:U,page_name:F,creativity:c.creativity,resemblance:c.resemblance,hdr_strength:c.hdr,prompt_length:prompt.length,negative_prompt_length:null===(t=c.negativePrompt)||void 0===t?void 0:t.length,advance_settings_used:!1,tokens_remaining:null==D?void 0:D.platformSpecificTotal,user_account_status:K,user_plan:B,user_plan_period:H};try{let e=await P.mutateAsync(c);j(r,e,!0,a),n={processing_status:"Successful"},ep.Am.success("Upscaled successfully")}catch(e){(0,eZ.eL)(e,l),n={processing_status:"Failure",processing_error:(0,eZ.t$)(e)}}V.log(d.H.clevertap.image_generated.withProperties({...m,txt_v2_variate:!0,...n})),w(r,!1,a)},$=async e=>{var t,n;let{collectionId:a,imageId:r}=e,i=T.find(e=>e.id===a),l=null==i?void 0:i.images.find(e=>e.id===r);if(!l)throw Error("Image not found");if(!i)throw Error("Collection not found");let s=i.settings.aspect_ratio;A(l.id,!0);let o={[e9.Y.ASPECT_RATIO]:s,[e9.Y.ANIMATE_PROMPT]:"4K",[e9.Y.UPLOADED_ANIMATE_IMAGE]:null!==(t=l.upscaleSrc)&&void 0!==t?t:l.src,[e9.Y.ANIMATE_CROPPED_IMAGE]:null!==(n=l.upscaleSrc)&&void 0!==n?n:l.src,[e9.Y.RECREATE_BUTTON_CLICKED]:!1};V.log(d.H.clevertap.click.withProperties({page_name:F,source:U,variant:e1.x.TEXT_IMAGE_V2,user_account_status:K,user_plan:B,user_plan_period:H,trigger:e0.U.ANIMATE_V2})),k({data:o,isUploadedImage:!1,shouldRedirect:!1,shouldRenderToastCTA:!0,onSuccess:()=>{O(l.id)},onError:()=>{O(l.id)}})},W=e=>{let{collectionId:t,imageId:n}=e;try{var a;let e=T.find(e=>e.id===t),r=null==e?void 0:e.images.find(e=>e.id===n);if(!r)throw Error("Image not found");if(!e)throw Error("Collection not found");V.log(d.H.clevertap.click.withProperties({page_name:F,source:U,variant:e1.x.TEXT_IMAGE_V2,user_account_status:K,user_plan:B,user_plan_period:H,trigger:e0.U.EDIT_V2}));let i=new URLSearchParams;i.set(e3.u.IMAGE_URL,null!==(a=r.upscaleSrc)&&void 0!==a?a:r.src),G.push("".concat(ee.H7.CANVAS_IMGLY,"?").concat(i.toString()))}catch(e){ep.Am.error("Failed to open image in editor")}},Z=async e=>{let{collectionId:t,imageId:n,navigateToFirstImage:a=()=>{}}=e;try{var r;let e=T.find(e=>e.id===t),i=null==e?void 0:e.images.find(e=>e.id===n);if(!i)throw Error("Image not found");if(!e)throw Error("Collection not found");V.log(d.H.clevertap.click.withProperties({page_name:F,source:U,variant:e1.x.TEXT_IMAGE_V2,user_account_status:K,user_plan:B,user_plan_period:H,trigger:e0.U.BG_REMOVE_V2}));let l=R(e.id);a();let s=await (0,ef.K$)(null!==(r=i.upscaleSrc)&&void 0!==r?r:i.src),o=await M.mutateAsync({imgBlob:s});if(!o)throw Error("Processing stopped");let c=await (0,ef.ug)(o),u=(0,ef.RJ)(c);C({image:{src:u},imageId:l.imageId,collectionId:e.id})}catch(e){(0,eZ.eL)(e,l)}},{openPopup:q,formId:J,formRef:et}=(0,e4.Z)({cookieKey:e2.R.SHOW_TEXT_FORM,darkModeFormId:e5._.TEXT_DARK_MODE,lightModeFormId:e5._.TEXT_LIGHT_MODE});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex flex-col gap-2",children:T.map(e=>(0,s.jsx)(to,{isPremium:l,collection:e,onFullView:X,onRegenerate:c,onDeleteCollection:y,onAnimateImage:$,onEditImage:W,onRemoveBackground:Z},e.id))}),-1!==E&&(0,s.jsx)(te.h,{closeFullViewModal:v,isFullViewOpen:f.isModalOpen,children:(0,s.jsx)(tt.c,{loaderVariant:"spinner",closeFullViewModal:v,collection:T[E],onDownload:()=>q(),initialImageIndex:f.initialImageIndex,getSettingItems:e=>_(e,T[E]),handleDeleteImage:e=>S({imageId:e,collectionId:T[E].id}),isVariationSupported:p(T[E]),handleImageUpscale:(e,t)=>{Y({imageId:e,collectionId:T[E].id,upscaleConfig:t})},handleImageVariate:(e,t)=>{I({imageId:e,collectionId:T[E].id,variateConfig:t})},type:"responsive",handleAnimateImage:$,handleEditImage:W,handleRemoveBackground:(e,t,n)=>{Z({imageId:e,collectionId:t,navigateToFirstImage:n})},version:"svi4"})}),(0,s.jsx)(eQ.PopupButton,{id:J,style:{display:"none"},size:60,embedRef:et})]})};var td=n(31355);let tu=()=>(0,s.jsx)("div",{className:"flex h-full min-h-[520px] w-full flex-1 items-center justify-center",children:(0,s.jsx)("div",{className:"aspect-square max-h-full overflow-hidden rounded bg-neutral-30 object-contain transition-all duration-500 dark:bg-neutral-900",children:(0,s.jsx)(td.V,{})})});var tm=n(42071),tg=n(2580),tp=n(37079);let th=e=>{let{generateTextToImageMutation:t,isPremium:n,credits:a,randomPrompts:r}=e,{formHook:i}=(0,p.s)(),l=S(e=>e.isOpen),o=(0,tg.a)(e=>e.isProcessing),c=(0,v.qo)({control:i.control,name:"should_focus"}),d=eq({generateTextToImageMutation:t,isPremium:n});return(0,s.jsx)("form",{onSubmit:i.handleSubmit(e=>d(e)),className:"flex h-[152px] w-full flex-shrink-0 justify-center",children:(0,s.jsx)(tp.w,{variant:"v2",className:"w-[480px] laptop:w-[650px] desktop:w-full",tagPopoverControlArgs:{control:i.control,name:"tags"},disabled:l,promptFormHook:{formHook:i,name:"prompt",tokenCost:a,isLoading:!1,onCancel:()=>{},disabled:o||l,generateBtnId:tm.i.GENERATE_BTN_ID},shouldFocus:c,onFocusComplete:()=>{i.setValue("should_focus",!1)},randomPrompts:r})})},t_=e=>{var t,n,a,r,i;let{randomPrompts:f}=e,[x,v]=(0,o.useState)({isModalOpen:!1,initialImageIndex:0}),I=eB(l.TEXT_TO_IMAGE),E=(0,ea.m8)()(e=>e.subscription),{isSubscriptionActive:b}=(0,eW.L)(E),T=eB(l.IMAGE_TO_IMAGE),{formHook:w}=(0,p.s)(),{cost:j}=eR(),y=S(e=>e.setIsOpen);eJ({generateTextToImageMutation:I,isPremium:b});let N=eq({generateTextToImageMutation:I,isPremium:b}),A=eY(e=>e.collections),O=(0,en.Td)()(e=>e.textToImageSviModels),C=eY(e=>e.completeImageGenerationLoadingOnGivenCollection),R=eY(e=>e.deleteLoadingImageFromGivenCollection),P=eY(e=>e.addImageToGivenCollectionWithLoading),{aggregator:M}=(0,eH.O)(),{page:G,source:k}=(0,g.V)(),L=(0,eW.L)(E),D=null===(a=L.stripeSubscription)||void 0===a?void 0:null===(n=a.StripePrice)||void 0===n?void 0:null===(t=n.StripeProduct)||void 0===t?void 0:t.name,z=null===(i=L.stripeSubscription)||void 0===i?void 0:null===(r=i.StripePrice)||void 0===r?void 0:r.billingInterval,V=L.isSubscriptionActive?"Premium":"Free",{data:F}=(0,eA.j)(),U=(null==F?void 0:F.platformSpecificTotal)?F.platformSpecificTotal-j:0,B=async e=>{var t,n,a;let r,{collectionId:i,imageId:l,variateConfig:s}=e,o=A.find(e=>e.id===i),c=null==o?void 0:o.images.find(e=>e.id===l);if(!c){ep.Am.error("Image for variation is not found");return}let m=JSON.parse(JSON.stringify(null!==(n=null==o?void 0:o.settings)&&void 0!==n?n:{}));if(!m){ep.Am.error("Please generate an image first and then variate it");return}let g=P(i,c),p={...m,...null!=s?s:{}},h={source:k,feature:u.L.TEXT_TO_IMAGE_V2,page_name:G,aspect_ratio:p.aspect_ratio,number_of_images:p.num_images,model_id:p.model.id,model_used:p.model.name,prompt_length:null===(t=p.prompt)||void 0===t?void 0:t.length,random_prompt_used:p.random_prompt_clicked,user_account_status:V,user_plan:D,user_plan_period:z,image_guidance:!!p.image_guidance.image,tokens_remaining:U,upload_image:!!p.image_guidance.image,txt_v2_image_strength:p.image_guidance.strength_mode,txt_v2_image_mode:null!==(a=p.image_guidance.mode)&&void 0!==a?a:"",style_used:p.style.style_name};try{let e=await T.mutateAsync({data:p,isPremium:b,imageForVariation:c.src});if(!e)throw ep.Am.error("Processing stopped"),R({imageId:g.imageId,collectionId:i}),Error("Processing stopped");C({image:e,imageId:g.imageId,collectionId:i}),r={processing_status:"Successful"}}catch(e){R({imageId:g.imageId,collectionId:i}),(0,eZ.eL)(e,b),r={processing_status:"Failure",processing_error:(0,eZ.t$)(e)}}M.log(d.H.clevertap.image_generated.withProperties({...h,txt_v2_variate:!0,...r}))};return(0,s.jsxs)("div",{className:"scrollbar__alt flex w-full flex-col overflow-auto",children:[0!==A.length||I.isLoading?(0,s.jsx)(_.w,{children:(0,s.jsx)(h._C,{children:(0,s.jsx)(tc,{fullViewModalState:x,setFullViewModalState:v,handleImageVariate:B,closeFullViewModal:()=>{v({isModalOpen:!1,initialImageIndex:0})},isPremium:b,useRequiredStore:eY,isVariationSupported:e=>{var t;let n=null==e?void 0:e.settings.model,a=O.find(e=>e.id===(null==n?void 0:n.id));return null===(t=null==a?void 0:a.variateEnabled)||void 0===t||t},getFullViewSettingItems:(e,t)=>{var n,a;return[{title:"Model",value:null==t?void 0:null===(n=t.settings.model)||void 0===n?void 0:n.name,image:"".concat(c.v.REMOTE_CONFIG_CDN).concat(null==t?void 0:null===(a=t.settings.model)||void 0===a?void 0:a.thumb)},{title:"Aspect Ratio",value:null==t?void 0:t.settings.aspect_ratio,Icon:(0,e$.o)(Object.values(m.TOOLS_SETTINGS.ASPECT_RATIO_SVI.content),null==t?void 0:t.settings.aspect_ratio)}]},submitHandler:N})})}):(0,s.jsx)(tu,{}),(0,s.jsx)(th,{credits:j,randomPrompts:f,isPremium:b,generateTextToImageMutation:I}),(0,s.jsx)(eN,{handleGenerateImage:e=>{w.setValue("prompt",e),N(w.getValues()),y(!1)},credits:j})]})}},63930:function(e,t,n){n.d(t,{I:function(){return j}});var a=n(57437),r=n(16463),i=n(80732),l=n(63218),s=n(96994),o=n(39082),c=n(6498),d=n(7530),u=n(89565),m=n(2753),g=n(50218),p=n(47802),h=n(8127);let _=async e=>{let{data:t,isUploadedImage:n}=e,a=t[m.Y.ANIMATE_CROPPED_IMAGE],r=t[m.Y.ANIMATE_PROMPT],i=t[m.Y.ASPECT_RATIO];if(!a)throw Error("No Image Provided");let l=await (0,h.K$)(a),s=(0,p.wh)({file:l,prompt:r,aspect_ratio:i,is_image_generated:n});return(0,g.v)(s)},f=()=>{let e=(0,u.useMutation)(_);return Object.assign(e,{cancelRequest:()=>{e.isLoading&&(0,g.C)()}})};var x=n(85951),v=n(81750),I=n(14125),E=n(29328),b=n(81149),T=n(82442),w=n(73141);let j=()=>{var e,t,n,u,g;let p=(0,r.useRouter)(),h=(0,r.usePathname)(),{aggregator:_}=(0,x.O)(),{page:j,source:S}=(0,s.V)(),{animateImageFormHook:y}=(0,o.m)(),N=f(),A=(0,v.m8)()(e=>e.subscription),{isSubscriptionActive:O}=(0,I.L)(A),C=(0,I.L)(A),R=null===(n=C.stripeSubscription)||void 0===n?void 0:null===(t=n.StripePrice)||void 0===t?void 0:null===(e=t.StripeProduct)||void 0===e?void 0:e.name,P=null===(g=C.stripeSubscription)||void 0===g?void 0:null===(u=g.StripePrice)||void 0===u?void 0:u.billingInterval,M=O?"Premium":"Free",{data:G}=(0,c.j)(),k=(0,v.m8)()(e=>e.user),{cost:L}=(0,d.f)({selectedTab:w.W.ANIMATE_IMAGE}),D=(null==G?void 0:G.platformSpecificTotal)?G.platformSpecificTotal-L:0;return{handleAnimateVideoGeneration:e=>{let{data:t,isUploadedImage:n,shouldRedirect:r=!0,shouldRenderToastCTA:s=!1,onSuccess:o=()=>{},onError:c=()=>{}}=e;N.mutate({data:t,isUploadedImage:n},{onSuccess:async()=>{o();let e={page_name:j,source:S,random_prompt_used:!1,add_style:!1,prompt_length:0,add_face:!1,upload_image:!0,recreate:t.recreate_button_clicked,aspect_ratio:t.aspect_ratio,user_account_status:M,user_plan:R,user_plan_period:P,tokens_remaining:D};if(_.log(i.H.mixpanel.video_generated.withProperties({...e,email:null==k?void 0:k.email,distinct_id:null==k?void 0:k.id})),_.log(i.H.clevertap.video_generated.withProperties(e)),T.Am.success("Your video generation request has been successfully received",s?{duration:4e3,renderCta:e=>(0,a.jsx)(b.z,{...e,onClick:()=>{p.push(l.H7.LIBRARY),setTimeout(()=>{p.refresh()},500)},children:"View Generation"})}:{}),y.setValue(m.Y.RECREATE_BUTTON_CLICKED,!1),r){if(!h.includes(l.H7.LIBRARY)){p.push(l.H7.LIBRARY);return}p.refresh()}},onError:e=>{(0,E.eL)(e,O),c()}})},animateMutation:N}}},73141:function(e,t,n){var a,r;n.d(t,{W:function(){return a}}),(r=a||(a={})).DESCRIBE_VIDEO="describe_video",r.ANIMATE_IMAGE="animate_image"},7530:function(e,t,n){n.d(t,{f:function(){return u}});var a=n(39343),r=n(39082),i=n(73141),l=n(6498),s=n(85546),o=n(54795),c=n(10733),d=n(72811);let u=e=>{var t;let{selectedTab:n,shouldUseFromTextConfig:u}=e,{videoGeneration:{describeVideo:m}}=(0,c.Td)()(e=>e.defaultSettings),{textImageToVideoFormHook:g}=(0,r.m)(),{isLoading:p,data:h}=(0,l.X)(),_=n===i.W.ANIMATE_IMAGE,f=(0,a.qo)({control:g.control,name:s.RH.MODEL_ID}),x=0;if(p)return{cost:x,videoGenerationBaseCost:0};let v=null==h?void 0:h[o.TG.FROM_TEXT],I=null==h?void 0:h[o.TG.CHARACTER_CONSISTENCY],E=null==h?void 0:h[o.TG.VIDEO_UPLOAD];if(!v||!E||!I)return{cost:x,videoGenerationBaseCost:0};let{criteria:b}=v,T=(0,d.l)(b,{model_id:f});return{cost:x=_?E.base:u?(T+v.base)*m[s.RH.NUM_IMAGES]+E.base:I.base*m[s.RH.NUM_IMAGES]+E.base,videoGenerationBaseCost:null!==(t=E.base)&&void 0!==t?t:0}}},97157:function(e,t,n){var a,r;n.d(t,{e:function(){return a}}),(r=a||(a={})).BASE="base",r.STRUCTURE="structure",r.FACE="face",r.STYLE="style"},15905:function(e,t,n){n.d(t,{U:function(){return l}});var a=n(52247),r=n(11141),i=n(70778);let l=new r.hE({baseURL:a.v.AUTH_API_URL,defaultHeadersGenerator:i.A})},45331:function(e,t,n){var a,r,i,l;n.d(t,{X:function(){return r}}),(i=a||(a={})).PDF="pdf",i.EXCEL="excel",i.WORD="word",(l=r||(r={})).SYSTEM="system",l.USER="user"},9938:function(e,t,n){n.d(t,{O:function(){return a}});let a=n(20920).Z},2753:function(e,t,n){n.d(t,{B:function(){return s},Y:function(){return r}});var a,r,i=n(59772),l=n(83231);(a=r||(r={})).UPLOADED_ANIMATE_IMAGE="uploaded_animate_image",a.ANIMATE_PROMPT="animate_prompt",a.ASPECT_RATIO="aspect_ratio",a.ANIMATE_CROPPED_IMAGE="animate_cropped_image",a.RECREATE_BUTTON_CLICKED="recreate_button_clicked";let s=i.z.object({uploaded_animate_image:l.KA,animate_prompt:l.Pp,aspect_ratio:i.z.string(),animate_cropped_image:l.KA,recreate_button_clicked:i.z.boolean().optional().default(!1)})},85546:function(e,t,n){n.d(t,{M0:function(){return s},RH:function(){return r}});var a,r,i=n(59772),l=n(83231);(a=r||(r={})).PROMPT="prompt",a.NUM_IMAGES="num_images",a.ASPECT_RATIO="aspect_ratio",a.MODEL_ID="model_id",a.STYLE_ID="style_id",a.FACE_IMAGE="face_image",a.STYLE_IMAGE="style_image",a.SEED="seed",a.IDENTITY_NET_STRENGTH="identitynet_strength",a.STEPS="steps",a.CFG="cfg",a.STYLE_STRENGTH="style_strength",a.NEGATIVE_PROMPT="negative_prompt",a.MODE="mode",a.ID_MIX="0",a.VIDEO_MODAL_ID="video_model_id",a.GENERATED_IMAGE="generated_image",a.IS_FACE_DETECTED="is_face_detected";let s=i.z.object({prompt:l.Pp,num_images:i.z.number(),aspect_ratio:i.z.string(),model_id:i.z.number(),style_id:i.z.number(),face_image:l.KA.optional(),style_image:l.KA.optional(),seed:l.TI,identitynet_strength:i.z.number().optional(),steps:i.z.number().optional(),cfg:i.z.number().optional(),style_strength:i.z.number().optional(),negative_prompt:i.z.string().optional(),mode:i.z.string().optional(),0:i.z.number().optional(),video_model_id:i.z.number(),is_face_detected:i.z.boolean().optional(),generated_image:l.KA,random_prompt_clicked:i.z.boolean().optional().default(!1)}).refine(e=>{let t=e.prompt,n=e.face_image,a=e.style_image,r=e.is_face_detected;return(!a||!!n)&&(!n||!!r)&&(""!==t.trim()||null!==n)},{message:"Either prompt or face image is required",path:["prompt","face_image","style_image","is_face_detected"]})},23045:function(e,t,n){n.d(t,{xG:function(){return p},xi:function(){return l}});var a=n(59772),r=n(83231),i=n(10579);let l={PROMPT:"prompt",NUM_IMAGES:"num_images",ASPECT_RATIO:"aspect_ratio",TRANSPARENCY:"transparency",TAGS:"tags",STRENGTH_MODE:"strength_mode",MODEL_LIST_ID:"modelListId",STYLE_LIST_ID:"styleListId",CONTROL_LIST_ID:"controlListId",MODEL:"model",STYLE:"style",IMAGE_GUIDANCE:"image_guidance"},s=a.z.object({low:a.z.number(),medium:a.z.number(),high:a.z.number()}),o=a.z.object({control_1_type:a.z.string(),variation:a.z.string(),strength:s}),c=a.z.object({image_caption:a.z.string().optional(),variation:a.z.string(),strength:s}),d=a.z.object({variation:a.z.string(),strength:s,has_detected_face:a.z.boolean().optional()}),u=a.z.object({variation:a.z.string(),strength:s}),m=a.z.object({image:r.KA,croppedImage:r.KA,mode:a.z.string().nullable(),base:c,structure:o,face:d,style:u,strength_mode:a.z.string().optional()}),g=i.SB.extend({is_image_guidance_disabled:a.z.boolean().optional()}),p=a.z.object({model:g,prompt:r.Pp,style:i.X2.omit({style_id:!0,init_prompt:!0,init_neg_prompt:!0,isPopular:!0}).extend({tag:a.z.string().optional().nullable()}),aspect_ratio:a.z.string(),num_images:a.z.number().min(1).max(8),transparency:a.z.boolean().optional(),image_guidance:m,tags:a.z.record(a.z.string(),a.z.set(a.z.string())),random_prompt_clicked:a.z.boolean().optional().default(!1),denoising_strength:a.z.number().optional(),should_focus:a.z.boolean().optional().default(!1)});m.omit({image:!0,croppedImage:!0,mode:!0})},45019:function(e,t,n){n.d(t,{Wb:function(){return l},kS:function(){return o},tc:function(){return s}});var a=n(15905),r=n(81284);let i="/auth/other",l=async e=>{if(!e)throw Error("Refresh token is not available");return await r.l.post("/".concat(i,"/refresh/web"),{headers:{Authorization:"Bearer ".concat(e)}})},s=async e=>{let{data:{result:t}}=await a.U.get("".concat(i,"/user-info/"),{params:{token:e}},{throwOnError:!0});return t},o=async()=>{await a.U.post("".concat(i,"/logout"),null,{throwOnError:!0})}},81284:function(e,t,n){n.d(t,{l:function(){return r}});var a=n(52247);let r=new(n(11141)).hE({baseURL:a.v.AUTH_API_URL})},9680:function(e,t,n){n.d(t,{r:function(){return i}});var a=n(52247);let r=new(n(11141)).hE({baseURL:a.v.PAYMENT_API_URL}),i=async e=>{let{data:{result:t}}=await r.get("/subscription/user",{headers:e,cache:"no-cache"},{throwOnError:!0});return t}},60806:function(e,t,n){n.d(t,{b:function(){return o}});var a=n(72143),r=n(54795),i=n(47802),l=n(8127);let s=async e=>{if(!e)throw Error("No image provided");let t=await (0,l.K$)(e);return(0,i.wh)({image:t})},o=async e=>{let{image:t}=e,n=await s(t),{data:i}=await a.p.post(r.TG.IMAGE_CAPTION,{body:n},{throwOnError:!0});return i}},50218:function(e,t,n){n.d(t,{C:function(){return s},v:function(){return l}});var a=n(72143),r=n(54795);let i=new AbortController,l=async e=>(i.signal.aborted&&(i=new AbortController),await a.p.post(r.TG.VIDEO_UPLOAD,{body:e,signal:i.signal},{throwOnError:!0})),s=()=>{i.abort()}},2580:function(e,t,n){n.d(t,{a:function(){return a}});let a=(0,n(39099).Ue)(e=>({isProcessing:!1,setIsProcessing:t=>e(()=>({isProcessing:t}))}))},36805:function(e,t,n){n.d(t,{Oj:function(){return f},gi:function(){return d},vK:function(){return u},Pl:function(){return _},J5:function(){return h},Ml:function(){return p},Lm:function(){return g}});var a=n(44785);n(12314);var r=n(52247),i=n(2053);n(52479);var l=n(1576),s=n(63218),o=n(73359),c=n(45019);n(81284),n(9680);let d=e=>{let{email:t="",isCompleteRedirectUrl:n=!1,open:a,redirect:i="",slug:l}=e,s=new URL("".concat(r.v.VYRO_AUTH_URL,"/").concat(l)),c=n?i:new URL(i||window.location.pathname,window.location.origin);s.searchParams.append(o.u.REDIRECT,c.toString()),s.searchParams.append(o.u.PRODUCT,"imagine"),a&&s.searchParams.append(o.u.OPEN,a),t&&s.searchParams.append(o.u.EMAIL,t),window.location.href=s.toString()},u=(e,t)=>{let n=new URL(s.H7.STRIPE_REDIRECT,window.location.origin),a=encodeURIComponent(e),r=encodeURIComponent(t.toString());n.searchParams.append(o.u.PRICE_ID,a),n.searchParams.append(o.u.QUANTITY,r),d({slug:i.d.SIGN_IN,redirect:n.toString(),isCompleteRedirectUrl:!0})},m=(e,t)=>{if(!t||!e)return!0;let n=Number(t);return new Date().getTime()>n},g=(e,t)=>{let n=new Date(Date.now()+216e5);e&&t.set(l.R.SESSION_ID,e,{expires:n})},p=e=>{let{token:t,refreshToken:n,tokenExpiresIn:a,cookies:r}=e,i=new Date(Date.now()+1e3*a),s=new Date(Date.now()+6048e5);n&&r.set(l.R.REFRESH_TOKEN,n,{expires:s}),t&&(r.set(l.R.TOKEN,t,{expires:i}),r.set(l.R.TOKEN_EXPIRES_IN,a.toString(),{expires:i}))},h=(e,t)=>{let n=t?t=>{var n;return null==e?void 0:null===(n=e.delete)||void 0===n?void 0:n.call(e,t)}:e=>a.Z.remove(e);n(l.R.TOKEN),n(l.R.REFRESH_TOKEN),n(l.R.TOKEN_EXPIRES_IN),n(l.R.SESSION_ID)},_=async(e,t,n)=>{if(!m(e,n))return;let a=await (0,c.Wb)(t);if("success"===a.code)return a.data.result;throw Error(a.error.message)},f=()=>{let e=a.Z.get(l.R.TOKEN);return e?"Bearer ".concat(e):""}}}]);